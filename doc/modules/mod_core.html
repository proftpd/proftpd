<!-- $Id: mod_core.html,v 1.7 2011-03-24 22:13:12 castaglia Exp $ -->
<!-- $Source: /home/proftpd-core/backup/proftp-cvsroot/proftpd/doc/modules/mod_core.html,v $ -->

<html>
<head>
<title>ProFTPD module mod_core</title>
</head>

<body bgcolor=white>

<hr>
<center>
<h2><b>ProFTPD module <code>mod_core</code></b></h2>
</center>
<hr><br>

<p>
The <code>mod_core</code> module handles most of the core FTP commands.

<h2>Directives</h2>
<ul>
  <li><a href="#Include">Include</a>
  <li><a href="#MaxCommandRate">MaxCommandRate</a>
  <li><a href="#ProcessTitles">ProcessTitles</a>
  <li><a href="#Protocols">Protocols</a>
  <li><a href="#Trace">Trace</a>
  <li><a href="#TraceLog">TraceLog</a>
  <li><a href="#TraceOptions">TraceOptions</a>
</ul>

<hr>
<h2><a name="Include">Include</a></h2>
<strong>Syntax:</strong> Include <em>path|pattern</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> server config, <code>&lt;VirtualHost&gt;</code>, <code>&lt;Global&gt;</code>, <code>&lt;Anonymous&gt;</code>, <code>&lt;Directory&gt;</code><br>
<strong>Module:</strong> mod_core<br>
<strong>Compatibility:</strong> 1.2.10rc1 and later

<p>
The <code>Include</code> directive allows inclusion of other configuration
files from within the server configuration files.

<p>
Shell-style (<code>fnmatch(3)</code>) wildcard characters can be used to
include several files at once, in alphabetical order.  In addition, if
<code>Include</code> points to a directory, rather than a file, then
<code>proftpd</code> will read all files in that directory.  <b>Note</b>
that including entire directories is <b>not</b> recommended, as it is easy to
accidentally leave temporary files in a directory that can cause
<code>proftpd</code> to fail.

<p>
The <em>path</em> must be an absolute path.

Examples:
<pre>
  Include /etc/proftpd/conf/tls.conf
  Include /etc/proftpd/conf/vhosts/*.conf
</pre>

<p>
<hr>
<h2><a name="MaxCommandRate">MaxCommandRate</a></h2>
<strong>Syntax:</strong> MaxCommandRate <em>count</em> <em>[secs]</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> server config, <code>&lt;VirtualHost&gt;</code>, <code>&lt;Global&gt;</code><br>
<strong>Module:</strong> mod_core<br>
<strong>Compatibility:</strong> 1.3.4rc2 and later

<p>
The <code>MaxCommandRate</code> directive is used to configure a maximum
number of commands per time interval, after which <code>proftpd</code> will
start injecting a delay before handling the command.  The more over the
configured command/sec rate the client is, the longer the delay.  This feature
is used to "throttle" automated and/or malicious clients.

<p>
For example:
<pre>
  MaxCommandRate 200
</pre>
sets a maximum command rate of 200 commands per sec. Or:
<pre>
  MaxCommandRate 500 2
</pre>
sets a maximum command rate of 500 commands every 2 secs.

<p>
<hr>
<h2><a name="ProcessTitles">ProcessTitles</a></h2>
<strong>Syntax:</strong> ProcessTitles <em>terse|verbose</em><br>
<strong>Default:</strong> ProcessTitles verbose<br>
<strong>Context:</strong> server config
<strong>Module:</strong> mod_core<br>
<strong>Compatibility:</strong> 1.3.4rc2 and later

<p>
The <code>ProcessTitles</code> directive is used to tweak how
<code>proftpd</code> modifies the process title for session processes.

<p>
By default, <code>proftpd</code> updates the process title to show the current
FTP command and its arguments for every session, <i>e.g.</i>:
<pre>
  # ps aux | grep proftpd
  proftpd  30667  0.0  0.1   7304  1584 ?        Ss   02:12   0:00 proftpd: (accepting connections)
  user1    31892  0.2  0.3   8004  3505 ?        SL   20:13   0:12 proftpd: user1 - remote.client1.com: RETR file1.doc
  user2    31934  0.0  0.3   8004  3500 ?        SL   21:27   0:00 proftpd: user2 - 4.3.2.1: STOR file2.zip
  user3    31891  0.2  0.3   8004  3504 ?        SL   20:11   0:09 proftpd: user3 - remote.client2.com: RETR whatever.iso
</pre>
This is the same as having:
<pre>
  ProcessTitles verbose
</pre>
in your proftpd.conf.

<p>
To obscure the process titles, you can use:
<pre>
  ProcessTitles terse
</pre>
which results in process titles which look like:
<pre>
  # ps aux | grep proftpd
  proftpd  30667  0.0  0.1   7304  1584 ?        Ss   02:12   0:00 proftpd: (accepting connections)
  user1    31892  0.2  0.3   8004  3505 ?        SL   20:13   0:12 proftpd: processing connection
  user2    31934  0.0  0.3   8004  3500 ?        SL   21:27   0:00 proftpd: processing connection
  user3    31891  0.2  0.3   8004  3504 ?        SL   20:11   0:09 proftpd: processing connection
</pre>

<p>
<hr>
<h2><a name="Protocols">Protocols</a></h2>
<strong>Syntax:</strong> Protocols <em>protocol1 ...</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> server config, <code>&lt;VirtualHost&gt;</code>, <code>&lt;Global&gt;</code><br>
<strong>Module:</strong> mod_core<br>
<strong>Compatibility:</strong> 1.3.4rc1 and later

<p>
The <code>Protocols</code> directive is used to enable/disable specific
protocols support by the <code>proftpd</code> and its collection of modules.
This directive can be used, in conjunction with the
<a href="../contrib/mod_ifsession.html"><code>mod_ifsession</code></a> module,
to enable certain features for specific users/groups/classes.

<p>
The allowed protocols must be configured as a space-delimited list.  For
example:
<pre>
  # Only enable FTPS and SFTP support, but not FTP or SCP
  Protocols ftps sftp
</pre>

<p>
The currently known/supported protocols include:
<ul>
  <li><code>ftp</code><br>
  <li><code>ftps</code> (from <a href="../contrib/mod_tls.html"><code>mod_tls</code></a>)<br>
  <li><code>scp</code> (from <a href="../contrib/mod_sftp.html"><code>mod_sftp</code></a>)<br>
  <li><code>sftp</code> (from <a href="../contrib/mod_sftp.html"><code>mod_sftp</code></a>)<br>
</ul>

<p>
<hr>
<h2><a name="Trace">Trace</a></h2>
<strong>Syntax:</strong> Trace <em>channel1:level1 ...</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> server config, <code>&lt;VirtualHost&gt;</code>, <code>&lt;Global&gt;</code><br>
<strong>Module:</strong> mod_core<br>
<strong>Compatibility:</strong> 1.3.1rc1 and later

<p>
The <code>Trace</code> directive is used to configure which trace channels
are logged to the <a href="#TraceLog"><code>TraceLog</code></a> file, and
which log levels for messages in that trace channel.

<p>
For example, to get the default trace channels logged:
<pre>
  Trace DEFAULT:10
</pre>

<p>
To disable logging of a particular trace channel entirely, use a log level
of zero, <i>e.g.</i>:
<pre>
  # Log all of the default trace channels <b>except</b> for 'lock' and
  # 'scoreboard'
  Trace DEFAULT:10 lock:0 scoreboard:0
</pre>

<p>
To see only a certain range of log levels in a given trace channel, you
can specify the log level range like this:
<pre>
  # Log only messages at levels 7-10 for the default channels
  TraceLog DEFAULT:7-10
</pre>

<p>
See the <a href="../howto/Tracing.html">Tracing</a> howto for more information.

<p>
<hr>
<h2><a name="TraceLog">TraceLog</a></h2>
<strong>Syntax:</strong> TraceLog <em>path</em><br>
<strong>Default:</strong> None<br> 
<strong>Context:</strong> server config<br>
<strong>Module:</strong> mod_core<br>
<strong>Compatibility:</strong> 1.3.1rc1 and later

<p>
The <code>TraceLog</code> directive is used to specify a log file for trace
logging messages.  The <em>path</em> parameter given must be the full path to
the file to use for logging.

<p>
Note that this path must <b>not</b> be to a world-writable directory and,
unless <code>AllowLogSymlinks</code> is explicitly set to <em>on</em>
(generally a bad idea), the path must <b>not</b> be a symbolic link.

<p>
See the <a href="../howto/Tracing.html">Tracing</a> howto for more information.

<p>
<hr>
<h2><a name="TraceOptions">TraceOptions</a></h2>
<strong>Syntax:</strong> TraceOptions <em>opt1 ... optN</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> &quot;server config&quot;, &lt;VirtualHost&gt;, &lt;Global&gt;<br>
<strong>Module:</strong> mod_core<br>
<strong>Compatibility:</strong> 1.3.4rc2 and later

<p>
The <code>TraceOptions</code> directive can be used to change the format
of the <a href="#TraceLog"><code>TraceLog</code></a> messages, <i>e.g.</i>
adding/remove certain fields of data.

<p>
The options supported by the <code>TraceOptions</code> directive are:
<ul>
  <li>ConnIPs
  <li>TimestampMillis
</ul>
These options are all <em>disabled</em> by default.

<p>
To enable an option, preface the option name with a '+' (plus) character;
to disable the option, use a '-' (minus) character prefix.  For example:
<pre>
  # Log timestamps inncluding millisecs, but do not include the connection
  # IP address/port information
  TraceOptions +TimestampMillis -ConnIPs
</pre>

<p>
<hr>
<h2><a name="Installation">Installation</a></h2>
The <code>mod_core</code>module is <b>always</b> installed.

<p>
<hr><br>

Author: <i>$Author: castaglia $</i><br>
Last Updated: <i>$Date: 2011-03-24 22:13:12 $</i><br>

<br><hr>

<font size=2><b><i>
&copy; Copyright 2000-2011 The ProFTPD Project<br>
 All Rights Reserved<br>
</i></b></font>

<hr><br>

</body>
</html>


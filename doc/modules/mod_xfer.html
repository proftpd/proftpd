<!-- $Id: mod_xfer.html,v 1.3 2011-02-21 03:08:33 castaglia Exp $ -->
<!-- $Source: /home/proftpd-core/backup/proftp-cvsroot/proftpd/doc/modules/mod_xfer.html,v $ -->

<html>
<head>
<title>ProFTPD module mod_xfer</title>
</head>

<body bgcolor=white>

<hr>
<center>
<h2><b>ProFTPD module <code>mod_xfer</code></b></h2>
</center>
<hr><br>

<p>
The <code>mod_xfer</code> module handles most of the FTP commands related to
file transfers.

<h2>Directives</h2>
<ul>
  <li><a href="#AllowOverwrite">AllowOverwrite</a>
  <li><a href="#AllowRetrieveRestart">AllowRetrieveRestart</a>
  <li><a href="#AllowStoreRestart">AllowStoreRestart</a>
  <li><a href="#DeleteAbortedStores">DeleteAbortedStores</a>
  <li><a href="#DisplayFileTransfer">DisplayFileTransfer</a>
  <li><a href="#HiddenStores">HiddenStores</a>
  <li><a href="#MaxRetrieveFileSize">MaxRetrieveFileSize</a>
  <li><a href="#MaxStoreFileSize">MaxStoreFileSize</a>
  <li><a href="#MaxTransfersPerHost">MaxTransfersPerHost</a>
  <li><a href="#MaxTransfersPerUser">MaxTransfersPerUser</a>
  <li><a href="#StoreUniquePrefix">StoreUniquePrefix</a>
  <li><a href="#TimeoutNoTransfer">TimeoutNoTransfer</a>
  <li><a href="#TimeoutStalled">TimeoutStalled</a>
  <li><a href="#TransferPriority">TransferPriority</a>
  <li><a href="#TransferRate">TransferRate</a>
  <li><a href="#UseSendfile">UseSendfile</a>
</ul>

<hr>
<h2><a name="TransferPriority">TransferPriority</a></h2>
<strong>Syntax:</strong> TransferPriority <em>cmd-list "low"|"medium"|"high"|number</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> server config, <code>&lt;VirtualHost&gt;</code>, <code>&lt;Global&gt;</code>, <code>&lt;Anonymous&gt;</code><br>
<strong>Module:</strong> mod_xfer<br>
<strong>Compatibility:</strong> 1.3.2rc1 and later

<p>
The <code>TransferPriority</code> directive is used to tweak the process
priority (<i>a la</i> <code>nice(1)</code>) of the session during data
transfers.  For example, large (or anonymous) data transfers can be configured
to have lower priorities, so as to get lower priority than other applications
from the kernel.

<p>
The <em>priority</em> parameter can one of the convenient "high", "medium", or
"low" keywords, or it can be an explicit number.  As per the
<code>nice(1)</code> man page, the higher the number, the lower the priority;
the highest priority is -20, and the lower priority is 19.

<p>
Examples:
<pre>
  # All data transfers get a low priority
  TransferPriority APPE,RETR,STOR low
</pre>
Or maybe only downloads should have lower priorities, but uploads should be
fine:
<pre>
  TransferPriority RETR low
</pre>

<p>
<hr>
<h2><a name="TransferRate">TransferRate</a></h2>
<strong>Syntax:</strong> TransferRate <em>cmd-list kbytes-per-sec[:free-bytes]</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> server config, <code>&lt;VirtualHost&gt;</code>, <code>&lt;Global&gt;</code>, <code>&lt;Anonymous&gt;</code>, <code>&lt;Directory&gt;</code>, .ftpaccess<br>
<strong>Module:</strong> mod_xfer<br>
<strong>Compatibility:</strong> 1.2.8rc1 and later

<p>
The <code>TransferRate</code> directive is used to set transfer rate limits
on the transfer of data.  This directive allows for transfer rates to be set
in a wide variety of contexts, on a per-command basis, and for certain subsets
of users (via
<a href="../contrib/mod_ifsession.html"><code>mod_ifsession</code></a>).
<b>Note</b> that these limits only apply to <i>an individual session</i>, and
do <b>not</b> apply to the overall transfer rate of the entire daemon.

<p>
The <em>cmd-list</em> parameter may be an comma-separated list of any of the
following commands: <code>APPE</code>, <code>RETR</code>, <code>STOR</code>,
and <code>STOU</code>.

<p>
The <em>kbytes-per-sec</em> parameter is the actual transfer rate to be applied.

<p>
The <em>free-bytes</em> parameter, if configured, allows that number of bytes
to be transferred before the rate limit is applied.  This allows for clients
transferring small files to be unthrottled, but for larger files, such as MP3s
and ISO images, to be throttled.

<p>
Here are some examples:
<pre>
  # Limit downloads for everyone
  TransferRate RETR 1.5

  # Limit uploads (and appends!) to the prolific users in the
  # lotsofuploadfiles.net domain. This presumes that a Class has been defined
  # for that domain, and that that Class has been named "uploaders". Let them
  # upload small files without throttling, though.

  &lt;IfClass uploaders&gt;
    TransferRate APPE,STOR 8.0:1024
  &lt;/IfClass&gt;
</pre>

<p>
<hr>
<h2><a name="UseSendfile">UseSendfile</a></h2>
<strong>Syntax:</strong> UseSendfile <em>on|off|len units|percentage</em><br>
<strong>Default:</strong> None<br>
<strong>Context:</strong> server config, <code>&lt;VirtualHost&gt;</code>, <code>&lt;Global&gt;</code>, <code>&lt;Anonymous&gt;</code>, <code>&lt;Directory&gt;</code>, .ftpaccess<br>
<strong>Module:</strong> mod_xfer<br>
<strong>Compatibility:</strong> 1.3.0rc1 and later

<p>
The <code>UseSendfile</code> directive controls use of <code>sendfile(2)</code>
functionality, which is an optimization for sending files to clients.  Use of
<code>sendfile(2)</code> functionality avoids separate read and send kernel
operations, and buffer allocations.  Read this
<a href="../howto/Sendfile.html">howto</a> for more details.

<p>
<hr>
<h2><a name="Installation">Installation</a></h2>
The <code>mod_xfer</code>module is <b>always</b> installed.

<p>
<hr><br>

Author: <i>$Author: castaglia $</i><br>
Last Updated: <i>$Date: 2011-02-21 03:08:33 $</i><br>

<br><hr>

<font size=2><b><i>
&copy; Copyright 2000-2011 The ProFTPD Project<br>
 All Rights Reserved<br>
</i></b></font>

<hr><br>
</body>
</html>

